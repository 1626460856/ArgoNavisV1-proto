syntax = "proto3";
package GroupCheck;

import "google/api/annotations.proto";

option go_package = "ArgoNavisV1/GroupCheck/api/groupCheck/v1;group_check";

// ========== 基础数据结构 ==========

// 学生信息
message StudentInfo {
  string student_id = 1;
  string student_name = 2;
  bool check = 3;  // 是否勾选
}

// 班级基本信息
message ClassBasicInfo {
  string class_id = 1;
  string class_name = 2;
  bool check = 3;  // 是否勾选
}

// 专业信息
message SubjectInfo {
  string subject_name = 1;
  bool check = 2;  // 是否勾选
  repeated ClassBasicInfo classes = 3;  // 班级列表
}

// 年级信息
message GradeLevel {
  string grade_id = 1;
  bool check = 2;  // 是否勾选
  repeated SubjectInfo subjects = 3;  // 专业列表
}

// 班级完整信息
message ClassFullInfo {
  string grade_id = 1;
  string subject_name = 2;
  string class_id = 3;
  string class_name = 4;
  repeated StudentInfo students = 5;  // 班级学生
}

// 群组基本信息
message GroupInfo {
  int32 group_id = 1;
  string group_name = 2;
  int32 category = 3;  // 0=班级，1=职位，2=按个人
}

// 个人群组/职位群组成员
message PersonItem {
  string student_id = 1;
  string student_name = 2;
}

// 班级群组成员
message ClassItem {
  string class_id = 1;
  string class_name = 2;
}

// 学生详情
message StudentDetail {
  string grade_id = 1;
  string subject_name = 2;
  string class_id = 3;
  string student_name = 4;
  string student_id = 5;
}

// ========== 请求/响应结构 ==========

// 获取群组详情请求
message GetGroupReq {
  int32 group_id = 1;
}

// 获取群组详情响应
message GetGroupResp {
  int32 code = 1;
  string message = 2;
  message GroupDetail {
    GroupInfo group_info = 1;
    repeated GradeLevel grade_level = 2;
    repeated ClassFullInfo class_info_list = 3;
  }
  GroupDetail group_detail = 3;
}

// 获取班级详情请求
message GetClassDetailReq {
  string class_id = 1;
}

// 获取班级详情响应
message GetClassDetailResp {
  int32 code = 1;
  string msg = 2;
  ClassFullInfo class_info = 3;
}

// 搜索学生请求
message SearchStudentReq {
  string student_name = 1;
}

// 搜索学生响应
message SearchStudentResp {
  int32 code = 1;
  string message = 2;
  repeated StudentDetail data = 3;
}

// 获取班级树请求
message GetGradeClassTreeReq {}
message GetPersonalGroupsReq{}
message GetClassGroupsReq {}
message GetPositionGroupsReq {}
// 获取班级树响应
message GetGradeClassTreeResp {
  int32 code = 1;
  string msg = 2;
  repeated GradeLevel data = 3;
}

// 获取个人群组列表响应
message ListPersonGroupResp {
  int32 code = 1;
  message GroupItem {
    int32 group_id = 1;
    string group_name = 2;
    repeated PersonItem person_list = 3;
  }
  repeated GroupItem data = 2;
}

// 获取职位群组列表响应
message ListPositionGroupResp {
  int32 code = 1;
  message GroupItem {
    int32 group_id = 1;
    string group_name = 2;
    repeated PersonItem person_list = 3;
  }
  repeated GroupItem data = 2;
}

// 获取班级群组列表响应
message ListClassGroupResp {
  int32 code = 1;
  message GroupItem {
    int32 group_id = 1;
    string group_name = 2;
    repeated ClassItem class_list = 3;
  }
  repeated GroupItem data = 2;
}


// ========== 服务定义 ==========
service GroupCheck {
  // 获取群组详情
  rpc GetGroup(GetGroupReq) returns (GetGroupResp) {
    option (google.api.http) = {
      post: "/group/details"
      body: "*"
    };
  }

  // 获取班级详情
  rpc GetClassDetail(GetClassDetailReq) returns (GetClassDetailResp) {
    option (google.api.http) = {
      get: "/group/create/class/info"
    };
  }

  // 搜索学生
  rpc SearchStudent(SearchStudentReq) returns (SearchStudentResp) {
    option (google.api.http) = {
      post: "/group/create/student/search"
      body: "*"
    };
  }

  // 获取年级-专业-班级层级
  rpc GetGradeClassTree(GetGradeClassTreeReq) returns (GetGradeClassTreeResp) {
    option (google.api.http) = {
      post: "/group/create/class/list"
      body: "*"
    };
  }

  // 获取个人群组列表
  rpc ListPersonGroup(GetPersonalGroupsReq) returns (ListPersonGroupResp) {
    option (google.api.http) = {
      get: "/group/list/personal"
    };
  }

  // 获取职位群组列表
  rpc ListJobGroup(GetPositionGroupsReq) returns (ListPositionGroupResp) {
    option (google.api.http) = {
      get: "/group/list/position"
    };
  }

  // 获取班级群组列表
  rpc ListClassGroup(GetClassGroupsReq) returns (ListClassGroupResp) {
    option (google.api.http) = {
      get: "/group/list/class"
    };
  }
}